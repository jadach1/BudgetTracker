@using System.Text.Json
@model List<Category>
@{
    var jsonString = JsonSerializer.Serialize(Model);
}

<h1 class="text-center">CATEGORIES</h1>
<div>
    <div class="row">
        <a asp-controller="Category" asp-action="Create" class="btn btn-secondary mb-3">
            <i class="bi bi-plus-circle"></i> Create New Category
        </a>
    </div>
    <table class="table table-striped">
        <partial name=".\DeleteCategoryModal\Delete_Category_Modal.cshtml" />
        <thead>
            <tr>
                <bold>Category Name</bold>
            </tr>
        </thead>
        <tbody>
            @foreach (var obj in Model.OrderBy(u => u.Name))
            {

                // dynamically create ID's for elements below
                var displayName = "displayName" + @obj.Id;
                var editName = "editName" + @obj.Id;
                var editButton = "editButton" + @obj.Id;
                var deleteButton = "delete_category_name_btn."+@obj.Id;
                <tr id=@displayName>
                    <td> @obj.Name</td>
                    <!--Edit name form-->
                    <td id=@editName hidden=true>
                        <form method="post" asp-controller="Category" asp-action="Edit">
                            <input hidden name="Id" class="form-control" value=@obj.Id >
                            <label for="Name">Edit Category Name</label>
                            <input class="bg-primary form-control" name="Name" type="text" value=@obj.Name>    
                        <!--DISPLAY name-->
                        <div class="btn-group my-1">
                            <button  class="bg-primary btn offset-1 col-2"
                                onclick="">done</button>
                            <a class="bg-secondary btn offset-1 col-3"
                                onclick="editName(@obj.Id,true);">back</a>
                            </div>
                       </form>
                    </td>
                  
                    <!--BUTTONS - edit and delete-->
                    <td>
                        <fieldset id=@editButton class="btn-group">
                            <button onclick="edit_Category_Name(@obj.Id,false);" class="w-75  btn btn-primary mx-2">
                                <i class="bi bi-pencil"></i> Edit
                            </button>
                            <a class="w-75 btn btn-primary mx-2" onclick="DeleteCategoryModal.check_If_Expenses_Exists(@obj.Id)">
                                <i class="bi bi-trash"></i> Remove
                            </a>
                        </fieldset>
                    </td>
                </tr>
            }

        </tbody>
    </table>
</div>
<partial name=".\DeleteCategoryModal\Script_Delete_Category_Modal.cshtml" model="@jsonString"/>

